pipeline
{
    agent any
   
    stages{
        stage('Packaging the Jar')
        {
            steps{
                bat '"C:\\Vignesh\\Softwares\\apache-maven-3.9.9-bin\\apache-maven-3.9.9\\bin\\mvn" clean package -DskipTests'
            }
        }
        
        stage('BUilding the Images')
        {
            steps{
                bat "docker build -t=sgvignesh2007/wordpress ."
            }
        }
        
        stage('pushing the image')
        {
			
            steps{
				bat 'docker login -u sgvignesh2007 -p Deepika123$'
                bat "docker push sgvignesh2007/wordpress"
            }
        }
        stage('Starting the Grid')
        {
			
            steps{			
                bat "docker-compose -f ./Compose/grid.yml up -d"
            }
        }
        stage('Executing the TestCases')
        {
			
            steps{
				bat "docker-compose -f ./Compose/wordpress.yml up --pull=always"              
            }
        }
    }
    
    post{
		always{
			bat "docker-compose -f ./Compose/grid.yml down"
			bat "docker-compose -f ./Compose/wordpress.yml down" 
			bat "docker logout"
		}
	}
}